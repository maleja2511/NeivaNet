{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{% block title %}NeivaNet{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/styles.css'%}" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
      integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
  </head>

  <body>
    <header>
      <div class="navbar">
        <div class="navbar_logo">
          <a href="{% url 'posts' %}"
            ><i class="fa-solid fa-ethernet" style="color: #ffffff"></i
          ></a>
        </div>
        <div class="navbar_page">
          <a
            href="{% url 'posts' %}"
            style="text-decoration: none; color: #ffffff"
            ><span> NEIVANET</span></a
          >
        </div>
        <div class="navbar_search">
          <form method="get" action="{% url 'posts' %}">
            <div class="search-wrapper">
              <input
                type="text"
                name="category"
                placeholder="Search posts by category.."
              />
              <button type="submit"><i class="fa fa-search"></i></button>
            </div>
          </form>
        </div>
        <div class="navbar_icons">
          <ul>
            <a href="" style="color:white">
              <li><i class="fa fa-globe"></i></li>
            </a>
            <a href="{% url 'logout' %}" style="color: white">
              <li><i class="fas fa-sign-out-alt"></i></li>
            </a>
          </ul>
        </div>
      </div>
    </header>

    <main>
      <div class="all">
        <div class="rowfixed"></div>
        <div class="left_row">
          <div class="left_row_profile">
            {% if user.userprofile and user.userprofile.profile_picture and user.userprofile.profile_picture.url != 'default.png' %}
            <img
              id="profile_pic"
              src="{{ user.userprofile.profile_picture.url }}"
              onerror="this.onerror=null;this.src='{% static 'default.png' %}';"
              alt="{{ profile_user.username }}"
            />
            {% else %}
            <img
              id="profile_pic"
              src="{% static 'default.png' %}"
              alt="Default Profile Pic"
            />
            {% endif %}
            <span>{{ user.username }}</span>
          </div>
          <div class="rowmenu">
            <ul>
              <li>
                <a href="{% url 'posts' %}" id="rowmenu-selected"><i class="fa fa-globe"></i>Publicaciones</a>
              </li>
              <li>
                <a href="{% url 'profile' %}"><i class="fa fa-user"></i>Perfil</a>
              </li>
            </ul>
          </div>
        </div>

        {% block content %}
        <!-- El contenido específico de cada página irá aquí -->
        {% endblock %}

        <div class="suggestions_row">
          <div class="row column_posts">
            <div class="row_title">
              <span>Top Servicios públicos</span>
              <span><a href="{% url 'posts' %}">Ver más</a></span>
            </div>
            <table class="mini_table">
              <!-- Agrega una clase para el estilo -->
              <!-- Encabezado de la tabla -->
              <thead>
                <tr>
                  <th>Categoría</th>
                  <th>Calificación</th>
                </tr>
              </thead>
              <!-- Cuerpo de la tabla -->
              <tbody>
                {% for category in categories_with_ranking %}
                <tr>
                  <td>{{ category.name }}</td>
                  <td>
                    {% for i in "12345" %} 
                        {% if forloop.counter <= category.average_score %}
                        <i class="fa-solid fa-star" style="color: #ffcd02"></i>
                        <!-- Estrella llena -->
                        {% else %}
                        <i class="fa-regular fa-star" style="color: #ffcd02"></i>
                        <!-- Estrella vacía -->
                        {% endif %}
                    {% endfor %}
                    <span>({{ category.average_score|floatformat:0 }}/5)</span>
                  </td>
                </tr>
                {% empty %}
                <tr>
                  <td colspan="4">No hay categorías disponibles.</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <!-- Aquí puedes poner un pie de página -->
    </footer>
  </body>
</html>
